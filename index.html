<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‰å¹³åå‘¨åºœå·¥ç¨‹è©³ç›¡å½™æ•´ç³»çµ±</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #27ae60;
            --bg: #f4f7f6;
            --editable-bg: #fffde7;
        }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: var(--bg); color: var(--primary); padding: 20px; line-height: 1.6; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.1); }
        
        h1 { text-align: center; margin-bottom: 5px; color: var(--primary); }
        .project-meta { text-align: center; color: #7f8c8d; font-size: 0.9em; margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-card { background: white; border: 1px solid #ddd; padding: 15px; border-radius: 8px; text-align: center; transition: 0.3s; }
        .stat-card.total { background: var(--primary); color: white; border: none; }
        .stat-card h3 { margin: 0; font-size: 0.9em; opacity: 0.8; }
        .stat-card p { margin: 5px 0 0 0; font-size: 1.4em; font-weight: bold; font-family: 'Consolas', monospace; }

        .company-section { margin-bottom: 40px; border: 1px solid #eee; border-radius: 8px; overflow: hidden; }
        .company-header { background: #ecf0f1; padding: 15px 20px; border-left: 6px solid var(--secondary); display: flex; justify-content: space-between; align-items: center; }
        .company-header h2 { margin: 0; font-size: 1.1em; }
        .contact-info { font-size: 0.85em; color: #34495e; text-align: right; }
        
        .project-block { padding: 20px; border-bottom: 1px solid #eee; }
        .project-block:last-child { border-bottom: none; }
        .project-title { font-weight: bold; color: var(--secondary); margin-bottom: 5px; display: flex; justify-content: space-between; align-items: center; }
        .project-date { font-size: 0.85em; color: #7f8c8d; margin-bottom: 10px; display: block; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9em; }
        th { background: #f8f9fa; padding: 10px; text-align: left; color: #7f8c8d; border-bottom: 1px solid #eee; }
        td { padding: 10px; border-bottom: 1px solid #f9f9f9; }
        
        .subtotal-row { background: #fdfaf0; font-weight: bold; }
        .subtotal-label { text-align: right; padding-right: 20px; color: #7f8c8d; }

        [contenteditable="true"]:hover { background: var(--editable-bg); border-radius: 4px; }
        .price-input { text-align: right; font-weight: bold; color: #e67e22; width: 120px; }
        .project-subtotal-val { text-align: right; font-weight: bold; color: var(--primary); font-family: 'Consolas', monospace; }
        .receipt-link { font-size: 0.85em; color: #3498db; text-decoration: none; border-bottom: 1px solid #3498db; }
        
        .remark-box { font-size: 0.85em; color: #e67e22; background: #fff5eb; padding: 10px; border-radius: 5px; margin-top: 10px; }
        
        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; border: none; }
            .receipt-link { border: none; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1 contenteditable="true">ä¸‰å¹³åå‘¨åºœå·¥ç¨‹è©³ç›¡å½™æ•´æ¸…å–®</h1>
    <div class="project-meta">
        <span contenteditable="true">æœ€å¾Œæ›´æ–°æ—¥æœŸï¼š2025å¹´12æœˆ24æ—¥</span>
    </div>

    <!-- é ‚éƒ¨çµ±è¨ˆçœ‹æ¿ -->
    <div class="dashboard">
        <div class="stat-card">
            <h3>å§¸å·çµ±åˆå·¥ç¨‹è¡Œ å°è¨ˆ</h3>
            <p id="subtotal-tsai">NT$ 0</p>
        </div>
        <div class="stat-card">
            <h3>ç¦å¤§é¡å·¥å»  å°è¨ˆ</h3>
            <p id="subtotal-fuda">NT$ 0</p>
        </div>
        <div class="stat-card total">
            <h3>å…¨æ¡ˆé ç®—ç¸½é‡‘é¡</h3>
            <p id="grand-total">NT$ 0</p>
        </div>
    </div>

    <!-- æ‰¿åŒ…å•† A: å§¸å·çµ±åˆå·¥ç¨‹è¡Œ -->
    <div class="company-section" id="section-tsai">
        <div class="company-header">
            <h2 contenteditable="true">æ‰¿åŒ…å–®ä½ï¼šå§¸å·çµ±åˆå·¥ç¨‹è¡Œ</h2>
            <div class="contact-info" contenteditable="true">
                é€£çµ¡äººï¼šè”¡æ–‡å½¥<br>
                é›»è©±ï¼š0979-736712
            </div>
        </div>

        <!-- 001: 2024/12/29 -->
        <div class="project-block" data-project="001">
            <div class="project-title">
                <span contenteditable="true">å·¥ç¨‹ 001ï¼šè”¡è€é—†é˜²é¢±æ¿æ²¹æ¼†å·¥ç¨‹</span>
                <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766540390/%E8%94%A1%E8%80%81%E9%97%86%E6%B2%B9%E6%BC%86%E5%B7%A5%E7%A8%8B%E5%B0%BE%E6%AC%BE_f9naj8.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹æ”¶æ“š ğŸ”—</a>
            </div>
            <span class="project-date" contenteditable="true">æ–½å·¥æ—¥æœŸï¼š2024/12/29-2025/01/08</span>
            <table>
                <thead>
                    <tr><th>æ˜ç´°é …ç›®</th><th style="width: 20%; text-align: center;">ç‹€æ…‹</th><th style="text-align: right;">é‡‘é¡</th></tr>
                </thead>
                <tbody>
                    <tr><td contenteditable="true">1. é˜²é¢±æ¿æ²¹æ¼†å·¥ç¨‹ - å‰é‡‘</td><td style="text-align: center;">å·²æ”¯ä»˜</td><td class="price-input" contenteditable="true" oninput="calculate()">35000</td></tr>
                    <tr><td contenteditable="true">2. é˜²é¢±æ¿æ²¹æ¼†å·¥ç¨‹ - å°¾æ¬¾</td><td style="text-align: center;">å·²æ”¯ä»˜</td><td class="price-input" contenteditable="true" oninput="calculate()">40000</td></tr>
                </tbody>
                <tfoot>
                    <tr class="subtotal-row">
                        <td colspan="2" class="subtotal-label">æœ¬é …å·¥ç¨‹å°è¨ˆ</td>
                        <td class="project-subtotal-val">0</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- 002: 2025/01/13 -->
        <div class="project-block" data-project="002">
            <div class="project-title">
                <span contenteditable="true">å·¥ç¨‹ 002ï¼šè”¡è€é—†æ°´å¡”èˆ‡ç†±æ°´å»ºç½® (æ˜ç´° 0-13)</span>
                <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766459914/%E8%94%A1%E8%80%81%E9%97%86%E9%9B%BB%E7%86%B1%E6%B0%B4%E5%99%A8-%E6%AC%84%E6%9D%86%E6%B2%B9%E6%BC%86-%E6%B0%B4%E5%A1%94%E5%B7%A5%E7%A8%8B_lgtokn.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹åŸä»¶ ğŸ”—</a>
            </div>
            <span class="project-date" contenteditable="true">æ–½å·¥æ—¥æœŸï¼š2025/01/13</span>
            <table>
                <thead>
                    <tr><th>ç·¨è™Ÿ</th><th>æ˜ç´°é …ç›®</th><th style="width: 15%; text-align: center;">æ•¸é‡</th><th style="text-align: right;">é‡‘é¡</th></tr>
                </thead>
                <tbody>
                    <tr><td style="text-align: center;">0</td><td contenteditable="true">åŸå¤ªé™½èƒ½ç§»é™¤é‹æ£„</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">8000</td></tr>
                    <tr><td style="text-align: center;">1</td><td contenteditable="true">20åŠ ä¾–å¿«ç†±é›»ç†±çˆ</td><td>1 æª¯</td><td class="price-input" contenteditable="true" oninput="calculate()">14800</td></tr>
                    <tr><td style="text-align: center;">2</td><td contenteditable="true">6Kéˆ¦åŠ ç†±å™¨</td><td>1 çµ„</td><td class="price-input" contenteditable="true" oninput="calculate()">2500</td></tr>
                    <tr><td style="text-align: center;">3</td><td contenteditable="true">æ¬„æ†æ²¹æ¼†å¤§å·¥</td><td>1.5 å·¥</td><td class="price-input" contenteditable="true" oninput="calculate()">4800</td></tr>
                    <tr><td style="text-align: center;">4</td><td contenteditable="true">æ¬„æ†æ¼†æ–™åŠè€—æ</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">3200</td></tr>
                    <tr><td style="text-align: center;">5</td><td contenteditable="true">æ°´é›»å·¥</td><td>3 å·¥</td><td class="price-input" contenteditable="true" oninput="calculate()">10500</td></tr>
                    <tr><td style="text-align: center;">6</td><td contenteditable="true">å°å·¥</td><td>2 å·¥</td><td class="price-input" contenteditable="true" oninput="calculate()">4000</td></tr>
                    <tr><td style="text-align: center;">7</td><td contenteditable="true">1é “è‡¥å¼ä¸éŠ¹é‹¼æ°´å¡”</td><td>1 çµ„</td><td class="price-input" contenteditable="true" oninput="calculate()">11000</td></tr>
                    <tr><td style="text-align: center;">8</td><td contenteditable="true">1HPé›»å­æ†å£“åŠ å£“é¦¬é”</td><td>1 çµ„</td><td class="price-input" contenteditable="true" oninput="calculate()">6500</td></tr>
                    <tr><td style="text-align: center;">9</td><td contenteditable="true">æ›´æ›å¦æ–™é›¶ä»¶</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">2500</td></tr>
                    <tr><td style="text-align: center;">10</td><td contenteditable="true">æ°´é›»/å°å·¥å®‰è£è²»</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">7300</td></tr>
                    <tr><td style="text-align: center;">11</td><td contenteditable="true">ç®¡ç†è²»</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">4000</td></tr>
                    <tr style="color: #999;"><td style="text-align: center;">12</td><td contenteditable="true">é«˜420ä¸éŠ¹é‹¼çˆ¬æ¢¯ (å·²åˆªé™¤)</td><td>-</td><td class="price-input" contenteditable="true" oninput="calculate()">0</td></tr>
                    <tr><td style="text-align: center;">13</td><td contenteditable="true">ç¾å ´é›œé …æ¸…ç†è²»</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">0</td></tr>
                </tbody>
                <tfoot>
                    <tr class="subtotal-row">
                        <td colspan="3" class="subtotal-label">æœ¬é …å·¥ç¨‹å°è¨ˆ</td>
                        <td class="project-subtotal-val">0</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- 003: 2025/01/17 -->
        <div class="project-block" data-project="003">
            <div class="project-title">
                <span contenteditable="true">å·¥ç¨‹ 003ï¼šæ’æ°´ç³»çµ±æ”¹å–„</span>
                <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766459487/%E8%94%A1%E8%80%81%E9%97%86%E9%80%9A%E6%B0%B4%E7%AE%A1%E5%B7%A5%E7%A8%8B_anzbjg.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹åŸä»¶ ğŸ”—</a>
            </div>
            <span class="project-date" contenteditable="true">æ–½å·¥æ—¥æœŸï¼š2025/01/17</span>
            <table>
                <thead>
                    <tr><th>æ˜ç´°é …ç›®</th><th style="width: 20%; text-align: center;">æ•¸é‡</th><th style="text-align: right;">é‡‘é¡</th></tr>
                </thead>
                <tbody>
                    <tr><td contenteditable="true">1. 2F æ’æ°´ç®¡æ”¹é€šæ–½ä½œ (å«äººå·¥èˆ‡å¦æ–™)</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">13750</td></tr>
                </tbody>
                <tfoot>
                    <tr class="subtotal-row">
                        <td colspan="2" class="subtotal-label">æœ¬é …å·¥ç¨‹å°è¨ˆ</td>
                        <td class="project-subtotal-val">0</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- 004: 2025/03/10 -->
        <div class="project-block" data-project="004">
            <div class="project-title">
                <span contenteditable="true">å·¥ç¨‹ 004ï¼šè”¡è€é—†é ‚æ¨“é˜²æ°´å·¥ç¨‹</span>
                <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766460067/%E8%94%A1%E8%80%81%E9%97%86%E9%9B%BB-%E9%A0%82%E6%A8%93%E9%98%B2%E6%B0%B4%E5%B7%A5%E7%A8%8B_ehfgwx.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹åŸä»¶ ğŸ”—</a>
            </div>
            <span class="project-date" contenteditable="true">æ–½å·¥æ—¥æœŸï¼š2025/03/10-2025/03/25</span>
            <table>
                <thead>
                    <tr><th>æ˜ç´°é …ç›®</th><th style="width: 20%; text-align: center;">è¦æ¨¡</th><th style="text-align: right;">é‡‘é¡</th></tr>
                </thead>
                <tbody>
                    <tr><td contenteditable="true">1. åŸåœ°é¢é«˜å£“æ¸…æ´—æ¸…ç†</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">12000</td></tr>
                    <tr><td contenteditable="true">2. å°ˆæ¥­é˜²æ°´æ–½ä½œ (å«ä¸‰å±¤å¡—æ–™)</td><td>80 åª</td><td class="price-input" contenteditable="true" oninput="calculate()">224000</td></tr>
                    <tr><td contenteditable="true">3. å·¥ç¨‹ç¾å ´ç®¡ç†è²»</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">14000</td></tr>
                </tbody>
                <tfoot>
                    <tr class="subtotal-row">
                        <td colspan="2" class="subtotal-label">æœ¬é …å·¥ç¨‹å°è¨ˆ</td>
                        <td class="project-subtotal-val">0</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- 005: 2025/04/07 -->
        <div class="project-block" data-project="005">
            <div class="project-title">
                <span contenteditable="true">å·¥ç¨‹ 005ï¼šå®¤å…§ç‡ˆå…·èˆ‡æ”¶å°¾</span>
                <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766461472/1%E8%94%A1%E8%80%81%E9%97%86%E9%9B%BB-%E5%AE%A4%E5%85%A7%E5%90%B8%E9%A0%82%E7%87%88%E5%8F%8A%E9%A6%AC%E9%81%94%E6%96%BD%E4%BD%9C%E5%B7%A5%E7%A8%8B_mapo9g.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹åŸä»¶ ğŸ”—</a>
            </div>
            <span class="project-date" contenteditable="true">æ–½å·¥æ—¥æœŸï¼š2025/04/07</span>
            <table>
                <thead>
                    <tr><th>æ˜ç´°é …ç›®</th><th style="width: 20%; text-align: center;">æ•¸é‡</th><th style="text-align: right;">é‡‘é¡</th></tr>
                </thead>
                <tbody>
                    <tr><td contenteditable="true">1. GA11ç³»åˆ—å¸é ‚é€ å‹ç‡ˆå…·èˆ‡ç¯€èƒ½ç‡ˆæ³¡</td><td>3 çµ„</td><td class="price-input" contenteditable="true" oninput="calculate()">10400</td></tr>
                    <tr><td contenteditable="true">2. å®¤å…§æ°´é›»æ”¶å°¾èˆ‡ç®¡ç†å¦æ–™è²»</td><td>1 å¼</td><td class="price-input" contenteditable="true" oninput="calculate()">6100</td></tr>
                </tbody>
                <tfoot>
                    <tr class="subtotal-row">
                        <td colspan="2" class="subtotal-label">æœ¬é …å·¥ç¨‹å°è¨ˆ</td>
                        <td class="project-subtotal-val">0</td>
                    </tr>
                </tfoot>
            </table>
            <div class="remark-box" contenteditable="true">è¨»ï¼šé‡‘é¡åŸç‚º 18,900 å…ƒï¼Œç¶“ä¿®æ­£æ‰£é™¤ 1,500 å…ƒã€‚</div>
        </div>
    </div>

    <!-- æ‰¿åŒ…å•† B: ç¦å¤§é¡å·¥å»  -->
    <div class="company-section" id="section-fuda">
        <div class="company-header">
            <h2 contenteditable="true">æ‰¿åŒ…å–®ä½ï¼šç¦å¤§é¡å·¥å» </h2>
            <div class="contact-info" contenteditable="true">
                é€£çµ¡äººï¼šå¤æ°¸ç¦<br>
                å‚™è¨»ï¼šå†·æ°£æ”¯æ¶æ–½ä½œ
            </div>
        </div>
        
        <!-- 006: 2024/06/04 -->
        <div class="project-block" data-project="006">
            <div class="project-title">
                <span contenteditable="true">å·¥ç¨‹ 006ï¼šç©ºèª¿æ”¯æ¶å›ºå®šå·¥ç¨‹</span>
                <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766460458/S__4481065_trobn9.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹åŸä»¶ ğŸ”—</a>
            </div>
            <span class="project-date" contenteditable="true">æ–½å·¥æ—¥æœŸï¼š2024/06/04</span>
            <table>
                <thead>
                    <tr><th>æ˜ç´°é …ç›®</th><th style="width: 20%; text-align: center;">æ•¸é‡</th><th style="text-align: right;">é‡‘é¡</th></tr>
                </thead>
                <tbody>
                    <tr><td contenteditable="true">1. å†·æ°£å®¤å¤–æ©Ÿå›ºå®šåº§å®‰è£ (å«ç™½éµè§’é‹¼)</td><td>6 åº§</td><td class="price-input" contenteditable="true" oninput="calculate()">35000</td></tr>
                </tbody>
                <tfoot>
                    <tr class="subtotal-row">
                        <td colspan="2" class="subtotal-label">æœ¬é …å·¥ç¨‹å°è¨ˆ</td>
                        <td class="project-subtotal-val">0</td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <div style="text-align: center; color: #bdc3c7; font-size: 0.8em; margin-top: 50px;">
        Â© 2025 ä¸‰å¹³åå‘¨åºœå·¥ç¨‹ç®¡ç†ç³»çµ± | å…§éƒ¨æŸ¥å¸³å°ˆç”¨
    </div>
</div>

<script>
    function calculate() {
        let grandTotal = 0;

        // è¨ˆç®— å§¸å·çµ±åˆå·¥ç¨‹è¡Œ (Tsai)
        let tsaiTotal = 0;
        const tsaiBlocks = document.querySelectorAll('#section-tsai .project-block');
        tsaiBlocks.forEach(block => {
            let projectSubtotal = 0;
            const inputs = block.querySelectorAll('.price-input');
            inputs.forEach(input => {
                let val = parseInt(input.innerText.replace(/,/g, '')) || 0;
                projectSubtotal += val;
            });
            block.querySelector('.project-subtotal-val').innerText = projectSubtotal.toLocaleString();
            tsaiTotal += projectSubtotal;
        });
        document.getElementById('subtotal-tsai').innerText = 'NT$ ' + tsaiTotal.toLocaleString();

        // è¨ˆç®— ç¦å¤§é¡å·¥å»  (Fuda)
        let fudaTotal = 0;
        const fudaBlocks = document.querySelectorAll('#section-fuda .project-block');
        fudaBlocks.forEach(block => {
            let projectSubtotal = 0;
            const inputs = block.querySelectorAll('.price-input');
            inputs.forEach(input => {
                let val = parseInt(input.innerText.replace(/,/g, '')) || 0;
                projectSubtotal += val;
            });
            block.querySelector('.project-subtotal-val').innerText = projectSubtotal.toLocaleString();
            fudaTotal += projectSubtotal;
        });
        document.getElementById('subtotal-fuda').innerText = 'NT$ ' + fudaTotal.toLocaleString();

        // ç¸½è¨ˆ
        grandTotal = tsaiTotal + fudaTotal;
        document.getElementById('grand-total').innerText = 'NT$ ' + grandTotal.toLocaleString();
    }

    // åˆå§‹åŒ–è¨ˆç®—
    window.onload = calculate;
</script>

</body>
</html>
