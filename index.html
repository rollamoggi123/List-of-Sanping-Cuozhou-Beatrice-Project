<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‰å¹³åå‘¨åºœå·¥ç¨‹å…¨æ¡ˆå½™æ•´ç³»çµ±</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #27ae60;
            --bg: #f4f7f6;
            --editable-bg: #fffde7;
        }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: var(--bg); color: var(--primary); padding: 20px; line-height: 1.6; }
        .container { max-width: 950px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.1); }
        
        h1 { text-align: center; margin-bottom: 5px; color: var(--primary); }
        .project-meta { text-align: center; color: #7f8c8d; font-size: 0.9em; margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        
        /* ç¸½é‡‘é¡çœ‹æ¿ */
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-card { background: white; border: 1px solid #ddd; padding: 15px; border-radius: 8px; text-align: center; transition: 0.3s; }
        .stat-card.total { background: var(--primary); color: white; border: none; }
        .stat-card h3 { margin: 0; font-size: 0.9em; opacity: 0.8; }
        .stat-card p { margin: 5px 0 0 0; font-size: 1.4em; font-weight: bold; font-family: 'Consolas', monospace; }

        /* å…¬å¸åˆ†çµ„å€å¡Š */
        .company-section { margin-bottom: 40px; }
        .company-header { background: #ecf0f1; padding: 10px 20px; border-radius: 8px 8px 0 0; border-left: 6px solid var(--secondary); display: flex; justify-content: space-between; align-items: center; }
        .company-header h2 { margin: 0; font-size: 1.2em; }
        
        table { width: 100%; border-collapse: collapse; background: white; border: 1px solid #eee; }
        th { background: #f8f9fa; padding: 12px; text-align: left; font-size: 0.85em; color: #7f8c8d; border-bottom: 2px solid #eee; }
        td { padding: 12px; border-bottom: 1px solid #f1f1f1; vertical-align: middle; }
        
        /* ç·¨è¼¯æ¨£å¼ */
        [contenteditable="true"] { padding: 2px 5px; border-radius: 4px; transition: 0.2s; }
        [contenteditable="true"]:hover { background: var(--editable-bg); outline: 1px dashed #e67e22; }
        [contenteditable="true"]:focus { background: var(--editable-bg); outline: 2px solid var(--secondary); }
        
        .price-input { text-align: right; font-weight: bold; color: #e67e22; }
        .receipt-link { font-size: 0.75em; color: #3498db; background: #ebf5fb; padding: 2px 6px; border-radius: 4px; text-decoration: none; display: inline-block; }
        .receipt-link:hover { background: #d6eaf8; }
        
        .remark-box { font-size: 0.85em; color: #e67e22; background: #fff5eb; padding: 10px; border-radius: 5px; margin-top: 10px; }
        
        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; border: none; }
            [contenteditable="true"]:hover { background: none; outline: none; }
            .receipt-link { color: black; background: none; border: 1px solid #ccc; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1 contenteditable="true">ä¸‰å¹³åå‘¨åºœå·¥ç¨‹å½™æ•´æ¸…å–®</h1>
    <div class="project-meta">
        <span contenteditable="true">æ›´æ–°æ—¥æœŸï¼š2025å¹´12æœˆ23æ—¥</span> | 
        <span contenteditable="true">å·¥ç¨‹åœ°é»ï¼šå°æ±ç¸£æ±æ²³é®</span>
    </div>

    <!-- çµ±è¨ˆçœ‹æ¿ (è‡ªå‹•åŠ ç¸½) -->
    <div class="dashboard">
        <div class="stat-card">
            <h3>è”¡æ–‡å½¥ å·¥ç¨‹å°è¨ˆ</h3>
            <p id="subtotal-tsai">NT$ 0</p>
        </div>
        <div class="stat-card">
            <h3>ç¦å¤§é¡å·¥å»  å·¥ç¨‹å°è¨ˆ</h3>
            <p id="subtotal-fuda">NT$ 0</p>
        </div>
        <div class="stat-card total">
            <h3>å…¨æ¡ˆé ç®—ç¸½é‡‘é¡</h3>
            <p id="grand-total">NT$ 0</p>
        </div>
    </div>

    <!-- å…¬å¸ A: è”¡æ–‡å½¥ -->
    <div class="company-section">
        <div class="company-header">
            <h2 contenteditable="true">å·¥ç¨‹å–®ä½ï¼šè”¡æ–‡å½¥</h2>
        </div>
        <table>
            <thead>
                <tr>
                    <th style="width: 10%;">åºè™Ÿ</th>
                    <th style="width: 50%;">æ–½å·¥é …ç›®èªªæ˜</th>
                    <th style="width: 25%;">å°æ‡‰æ”¶æ“š/è­‰æ˜</th>
                    <th style="width: 15%; text-align: right;">é‡‘é¡ (NT$)</th>
                </tr>
            </thead>
            <tbody id="tsai-body">
                <tr>
                    <td>å·¥ç¨‹ 01</td>
                    <td contenteditable="true">é ‚æ¨“é˜²æ°´å·¥ç¨‹ (é«˜å£“æ¸…ç†ã€80åªæ–½ä½œã€ç®¡ç†è²»)</td>
                    <td>
                        <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766460067/%E8%94%A1%E8%80%81%E9%97%86%E9%9B%BB-%E9%A0%82%E6%A8%93%E9%98%B2%E6%B0%B4%E5%B7%A5%E7%A8%8B_ehfgwx.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹é ‚æ¨“é˜²æ°´æ”¶æ“š ğŸ”—</a>
                    </td>
                    <td class="price-input" contenteditable="true" oninput="calculate()">250000</td>
                </tr>
                <tr>
                    <td>å·¥ç¨‹ 02</td>
                    <td contenteditable="true">æ”¹é€š2Fæ’æ°´ç®¡</td>
                    <td>
                        <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766459487/%E8%94%A1%E8%80%81%E9%97%86%E9%80%9A%E6%B0%B4%E7%AE%A1%E5%B7%A5%E7%A8%8B_anzbjg.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹é€šæ°´ç®¡æ”¶æ“š ğŸ”—</a>
                    </td>
                    <td class="price-input" contenteditable="true" oninput="calculate()">13750</td>
                </tr>
                <tr>
                    <td>å·¥ç¨‹ 03</td>
                    <td contenteditable="true">æ°´ç³»çµ±èˆ‡ç†±æ°´ä¾›æ‡‰ (é›»ç†±çˆã€æ°´å¡”ã€é¦¬é”ã€å¤ªé™½èƒ½æ‹†é™¤)</td>
                    <td>
                        <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766459914/%E8%94%A1%E8%80%81%E9%97%86%E9%9B%BB%E7%86%B1%E6%B0%B4%E5%99%A8-%E6%AC%84%E6%9D%86%E6%B2%B9%E6%BC%86-%E6%B0%B4%E5%A1%94%E5%B7%A5%E7%A8%8B_lgtokn.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹æ°´ç³»çµ±å·¥ç¨‹æ”¶æ“š ğŸ”—</a>
                    </td>
                    <td class="price-input" contenteditable="true" oninput="calculate()">69800</td>
                </tr>
                <tr>
                    <td>å·¥ç¨‹ 05</td>
                    <td contenteditable="true">å®¤å…§ç‡ˆå…·å®‰è£èˆ‡æ”¶å°¾ (é€ å‹ç‡ˆå…·çµ„ã€å·¥è³‡ã€ç®¡ç†è²»)</td>
                    <td>
                        <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766459859/%E8%94%A1%E8%80%81%E9%97%86%E9%9B%BB-%E5%AE%A4%E5%85%A7%E5%90%B8%E9%A0%82%E7%87%88%E5%8F%8A%E9%A6%AC%E9%81%94%E6%96%BD%E4%BD%9C%E5%B7%A5%E7%A8%8B_ukvb7d.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹ç‡ˆå…·/é¦¬é”æ”¶æ“š ğŸ”—</a>
                    </td>
                    <td class="price-input" contenteditable="true" oninput="calculate()">18900</td>
                </tr>
            </tbody>
        </table>
        <div class="remark-box" contenteditable="true">è¨»è¨˜ï¼šå·¥ç¨‹ 03 åŸå§‹é‡‘é¡ 84,800 å·²æ‰£é™¤çˆ¬æ¢¯ 15,000 å…ƒã€‚</div>
    </div>

    <!-- å…¬å¸ B: ç¦å¤§é¡å·¥å»  -->
    <div class="company-section">
        <div class="company-header">
            <h2 contenteditable="true">å·¥ç¨‹å–®ä½ï¼šç¦å¤§é¡å·¥å» </h2>
        </div>
        <table>
            <thead>
                <tr>
                    <th style="width: 10%;">åºè™Ÿ</th>
                    <th style="width: 50%;">æ–½å·¥é …ç›®èªªæ˜</th>
                    <th style="width: 25%;">å°æ‡‰æ”¶æ“š/è­‰æ˜</th>
                    <th style="width: 15%; text-align: right;">é‡‘é¡ (NT$)</th>
                </tr>
            </thead>
            <tbody id="fuda-body">
                <tr>
                    <td>å·¥ç¨‹ 04</td>
                    <td contenteditable="true">ç©ºèª¿ç³»çµ±å›ºå®šå·¥ç¨‹ (6åº§å†·æ°£å›ºå®šæ”¯æ¶ã€ç™½éµè§’é‹¼)</td>
                    <td>
                        <a href="https://res.cloudinary.com/dm1ksvptk/image/upload/v1766460458/S__4481065_trobn9.jpg" target="_blank" class="receipt-link">æŸ¥çœ‹ç©ºèª¿æ”¯æ¶æ”¶æ“š ğŸ”—</a>
                    </td>
                    <td class="price-input" contenteditable="true" oninput="calculate()">35000</td>
                </tr>
            </tbody>
        </table>
        <div class="remark-box" contenteditable="true">è¨»è¨˜ï¼šç”±ç¦å¤§é¡å·¥å» å¤æ°¸ç¦å…ˆç”Ÿè² è²¬æ–½ä½œã€‚</div>
    </div>

    <div style="text-align: center; color: #bdc3c7; font-size: 0.8em; margin-top: 50px;">
        Â© 2025 ä¸‰å¹³åå‘¨åºœå·¥ç¨‹ç®¡ç†ç³»çµ±
    </div>
</div>

<script>
    function calculate() {
        // è¨ˆç®— è”¡æ–‡å½¥ å°è¨ˆ
        let tsaiTotal = 0;
        const tsaiPrices = document.querySelectorAll('#tsai-body .price-input');
        tsaiPrices.forEach(cell => {
            let val = parseInt(cell.innerText.replace(/,/g, '').replace(/NT\$/g, '')) || 0;
            tsaiTotal += val;
        });
        document.getElementById('subtotal-tsai').innerText = 'NT$ ' + tsaiTotal.toLocaleString();

        // è¨ˆç®— ç¦å¤§é¡å·¥å»  å°è¨ˆ
        let fudaTotal = 0;
        const fudaPrices = document.querySelectorAll('#fuda-body .price-input');
        fudaPrices.forEach(cell => {
            let val = parseInt(cell.innerText.replace(/,/g, '').replace(/NT\$/g, '')) || 0;
            fudaTotal += val;
        });
        document.getElementById('subtotal-fuda').innerText = 'NT$ ' + fudaTotal.toLocaleString();

        // è¨ˆç®— ç¸½è¨ˆ
        const grandTotal = tsaiTotal + fudaTotal;
        document.getElementById('grand-total').innerText = 'NT$ ' + grandTotal.toLocaleString();
    }

    // åˆå§‹åŒ–è¨ˆç®—
    window.onload = calculate;
</script>

</body>
</html>